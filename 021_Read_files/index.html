<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Prof P. Lewis">
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Read Files - GEOG0111</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>
  <link href='https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Read Files";
    var mkdocs_page_input_path = "021_Read_files.md";
    var mkdocs_page_url = "/geog0111/021_Read_files/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-1347772-1', 'auto');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> GEOG0111</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="tocbase current">
    
    
      


  <li class="navtree toctree-l1 inactive">
    <a class="" href="..">Introduction</a>
  </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Course Basics</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../001_Notebook_use/">Notebook Use</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../002_Unix/">Unix</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../003_Help/">Help</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../004_Accounts/">Accounts</a>
  </li>
        
          
  <li class="navtree toctree-l2 label">
    <p class="caption">Answers</p>
  </li>


  

  
    <li class="navtree toctree-l2 group">
      <ul class="navtree subnav-l2 current">
          


  <li class="navtree toctree-l3 inactive">
    <a class="" href="../001_Notebook_use_answers/">Notebook Use</a>
  </li>
        
          


  <li class="navtree toctree-l3 inactive">
    <a class="" href="../002_Unix_answers/">Unix</a>
  </li>
        
          


  <li class="navtree toctree-l3 inactive">
    <a class="" href="../003_Help_answers/">Help</a>
  </li>
        
      </ul>
    </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Core Concepts</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../010_Python_Introduction/">Python Introduction</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../011_Python_data_types/">Python Data Types</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../012_Python_strings/">Python Strings</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../013_Python_string_methods/">Python String Methods</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../014_Python_groups/">Python Groups</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../015_Python_control/">Python Control</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../016_Python_for/">Python For</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../017_Functions/">Functions</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../018_Packages/">Packages</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../019_Running_Python/">Running Python</a>
  </li>
        
          
  <li class="navtree toctree-l2 label">
    <p class="caption">Answers</p>
  </li>


  

  
    <li class="navtree toctree-l2 group">
      <ul class="navtree subnav-l2 current">
          


  <li class="navtree toctree-l3 inactive">
    <a class="" href="../010_Python_Introduction_answers/">Python Introduction</a>
  </li>
        
          


  <li class="navtree toctree-l3 inactive">
    <a class="" href="../011_Python_data_types_answers/">Python Data Types</a>
  </li>
        
          


  <li class="navtree toctree-l3 inactive">
    <a class="" href="../012_Python_strings_answers/">Python Strings</a>
  </li>
        
          


  <li class="navtree toctree-l3 inactive">
    <a class="" href="../013_Python_string_methods_answers/">Python String Methods</a>
  </li>
        
          


  <li class="navtree toctree-l3 inactive">
    <a class="" href="../014_Python_groups_answers/">Python Groups</a>
  </li>
        
          


  <li class="navtree toctree-l3 inactive">
    <a class="" href="../015_Python_control_answers/">Python Control</a>
  </li>
        
          


  <li class="navtree toctree-l3 inactive">
    <a class="" href="../016_Python_for_answers/">Python For</a>
  </li>
        
          


  <li class="navtree toctree-l3 inactive">
    <a class="" href="../017_Functions_answers/">Functions</a>
  </li>
        
          


  <li class="navtree toctree-l3 inactive">
    <a class="" href="../019_Running_Python_answers/">Running Python</a>
  </li>
        
      </ul>
    </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Datasets</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../020_NASA_MODIS_Earthdata/">NASA MODIS Earthdata</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../020_Python_files/">Python Files</a>
  </li>
        
          


  
    
    <li class="navtree toctree-l2 page current">
      <a class="current" href="./">
        Read Files
          <span class="toctree-expand"></span>
      </a>
    </li>
    
      

  <li class="toctree-l2 current with-children">
    <a href="#021-read-files">
      021 Read Files
      <span class="toctree-expand"></span>
    </a>
  </li>



  <li class="toctree-l2 current">
    <ul class="subnav-l2 current">
    
      
          

  <li class="toctree-l3 current with-children">
    <a href="#introduction">
      Introduction
      <span class="toctree-expand"></span>
    </a>
  </li>



  <li class="toctree-l3 current">
    <ul class="subnav-l3 current">
    
      
        <li class="toctree-l4">
          <a class="toctree-l5" href="#purpose">Purpose</a>
        </li>
    
      
        <li class="toctree-l4">
          <a class="toctree-l5" href="#prerequisites">Prerequisites</a>
        </li>
    
      
        <li class="toctree-l4">
          <a class="toctree-l5" href="#test">Test</a>
        </li>
    
    </ul>
  </li>

      
    
      
          

  <li class="toctree-l3">
    <a href="#reading-and-writing">
      Reading and writing
      <span class="toctree-expand"></span>
    </a>
  </li>



  <li class="toctree-l3">
    <ul class="subnav-l3 toc-hidden">
    
      
        <li class="toctree-l4">
          <a class="toctree-l5" href="#with-as-pathopen-urlopen-yaml-json">with ... as ..., Path.open, URL.open, yaml, json</a>
        </li>
    
    </ul>
  </li>

      
    
      
          

  <li class="toctree-l3">
    <a href="#read-and-write-text">
      read and write text
      <span class="toctree-expand"></span>
    </a>
  </li>



  <li class="toctree-l3">
    <ul class="subnav-l3 toc-hidden">
    
      
        <li class="toctree-l4">
          <a class="toctree-l5" href="#exercise-1">Exercise 1</a>
        </li>
    
      
        <li class="toctree-l4">
          <a class="toctree-l5" href="#exercise-2">Exercise 2</a>
        </li>
    
    </ul>
  </li>

      
    
      
          

  <li class="toctree-l3">
    <a href="#read-and-write-binary-data">
      read and write binary data
      <span class="toctree-expand"></span>
    </a>
  </li>



  <li class="toctree-l3">
    <ul class="subnav-l3 toc-hidden">
    
      
          

  <li class="toctree-l4 current with-children">
    <a href="#exercise-3">
      Exercise 3
      <span class="toctree-expand"></span>
    </a>
  </li>



  <li class="toctree-l4 current">
    <ul class="subnav-l4 current">
    
      
        <li class="toctree-l5">
          <a class="toctree-l6" href="#exercise-4">Exercise 4</a>
        </li>
    
    </ul>
  </li>

      
    
      
        <li class="toctree-l4">
          <a class="toctree-l5" href="#135-summary">1.3.5 Summary</a>
        </li>
    
    </ul>
  </li>

      
    
    </ul>
  </li>


  
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../022_NASA_MODIS_Earthdata/">NASA MODIS Earthdata</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../022_Pandas_and_plotting/">Pandas And Plotting</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../024_GoogleEarthEngine/">Google Earth Engine</a>
  </li>
        
          
  <li class="navtree toctree-l2 label">
    <p class="caption">Answers</p>
  </li>


  

  
    <li class="navtree toctree-l2 group">
      <ul class="navtree subnav-l2 current">
          


  <li class="navtree toctree-l3 inactive">
    <a class="" href="../020_NASA_MODIS_Earthdata_answers/">NASA MODIS Earthdata</a>
  </li>
        
          


  <li class="navtree toctree-l3 inactive">
    <a class="" href="../020_Python_files_answers/">Python Files</a>
  </li>
        
          


  <li class="navtree toctree-l3 inactive">
    <a class="" href="../021_Read_files_answers/">Read Files</a>
  </li>
        
          


  <li class="navtree toctree-l3 inactive">
    <a class="" href="../022_NASA_MODIS_Earthdata_answers/">NASA MODIS Earthdata</a>
  </li>
        
      </ul>
    </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Image Processing</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../031_Numpy_matplotlib/">Numpy Matplotlib</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../031_Plotting/">Plotting</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Geospatial Data</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../040_GDAL/">GDAL</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../041_MODIS_download/">MODIS Download</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../042_GDAL_masking/">GDAL Masking</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../043_GDAL_stacking_and_interpolating/">GDAL Stacking And Interpolating</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../044_GDAL_Reconciling_projections/">GDAL Reconciling Projections</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Modelling</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../050_Linear_models/">Linear Models</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../051_Modelling_and_optimisation/">Modelling And Optimisation</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Developers</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../DEV_Local_Install/">Local Install</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../DEV_scripts/">Scripts</a>
  </li>
        
      </ul>
    </li>
    
  </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">GEOG0111</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Datasets &raquo;</li>
        
      
    
    <li>Read Files</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/UCL-EO/geog0111/edit/master/docs/021_Read_files.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="021-read-files">021 Read Files</h1>
<h2 id="introduction">Introduction</h2>
<h3 id="purpose">Purpose</h3>
<p>In this session, we will learn how to read files and similar resources. We will mainly use <a href="https://docs.python.org/3/library/pathlib.html"><code>pathlib</code></a> and the local package <a href="geog0111/gurlpath">gurlpath</a> derived from <a href="https://github.com/chrono-meter/urlpath"><code>urlpath</code></a>. We will also cover opening and closing files, and some simple read- and write-operations.</p>
<h3 id="prerequisites">Prerequisites</h3>
<p>You will need some understanding of the following:</p>
<ul>
<li><a href="../001_Notebook_use/">001 Using Notebooks</a></li>
<li><a href="../002_Unix/">002 Unix</a> with a good familiarity with the UNIX commands we have been through.</li>
<li><a href="../003_Help/">003 Getting help</a></li>
<li><a href="../010_Python_Introduction/">010 Variables, comments and print()</a></li>
<li><a href="../011_Python_data_types/">011 Data types</a> </li>
<li><a href="../012_Python_strings/">012 String formatting</a></li>
<li><a href="../013_Python_string_methods/">013_Python_string_methods</a></li>
<li><a href="../020_Python_files/">020_Python_files</a></li>
</ul>
<p>You will need to recall details from <a href="../020_Python_files/">020_Python_files</a> on using the two packages.</p>
<h3 id="test">Test</h3>
<p>You will need a web login to NASA Earthdata and to have stored this using <code>cylog</code> according to <a href="../004_Accounts/">004_Accounts</a> for the site <code>https://e4ftl01.cr.usgs.gov</code>. We can test this with the following code ius yoiu set do_test to True:</p>
<pre><code class="python">from geog0111.gurlpath import URL
# ping small (1.3 M) test file
site='https://e4ftl01.cr.usgs.gov/'
test_dir='MOLA/MYD11_L2.006/2002.07.04'
test_file='MYD11_L2*0325*.hdf'
# this glob interprets the wildcards to get at a suitable test file
url = URL(site,test_dir).glob(test_file,verbose=False)[0]
# test ping returns True
assert url.ping(verbose=False) == True
</code></pre>

<p>If this fails, set <code>verbose</code> to <code>True</code> to see what is going on, then if you can;'t work it out from there, go back to <a href="../004_Accounts/">004_Accounts</a> and sort the login for NASA Earthdata the site <code>https://e4ftl01.cr.usgs.gov</code>.</p>
<h2 id="reading-and-writing">Reading and writing</h2>
<p>We can conveniently use <code>pathlib</code> to deal with file input and output. The main methods to be aware of are:</p>
<table>
<thead>
<tr>
<th>command</th>
<th>purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Path.open()</code></td>
<td>open a file and return a file descriptor</td>
</tr>
<tr>
<td><code>Path.read_text()</code></td>
<td>read text</td>
</tr>
<tr>
<td><code>Path.write_text()</code></td>
<td>write text</td>
</tr>
<tr>
<td><code>Path.read_bytes()</code></td>
<td>read byte data</td>
</tr>
<tr>
<td><code>Path.write_bytes()</code></td>
<td>write byte data</td>
</tr>
</tbody>
</table>
<p>For <code>gurlpath</code> we have the following equivalent functions:</p>
<table>
<thead>
<tr>
<th>command</th>
<th>purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>URL.open()</code></td>
<td>open a file descriptor with data from a URL</td>
</tr>
<tr>
<td><code>URL.read_text()</code></td>
<td>read text from URL</td>
</tr>
<tr>
<td><code>URL.write_text()</code></td>
<td>write text to file</td>
</tr>
<tr>
<td><code>URL.read_bytes()</code></td>
<td>read byte data from URL</td>
</tr>
<tr>
<td><code>URL.write_bytes()</code></td>
<td>write byte data to file</td>
</tr>
</tbody>
</table>
<p>Notice that the <code>write</code> functions (and <code>open</code> when used for write) write to local files, not to the URL. </p>
<p>They have a keyword argument <code>local_file</code> to set the location to write the file to. If this is not given, the the directory structure of the URL is used (relative to the current directory). Alternatively, you can settrhe keyword <code>local_dr</code>, or set <code>URL.local_file</code> or <code>URL.local_dir</code> as appropriate. </p>
<p>Note that <code>URL</code> is tolerant of calling with a <code>Path</code>: if we call <code>URL</code> with a local file, most operations will continue and apply the appropriate <code>Path</code> function.</p>
<h3 id="with-as-pathopen-urlopen-yaml-json"><code>with ... as ...</code>, <code>Path.open</code>, <code>URL.open</code>, <code>yaml</code>, <code>json</code></h3>
<p>Quite often, we will use specific packages for reading particular file formats. But often we just need to be able to open a file (to get a file descriptor) or just to read some binary of text data from a file, or write straight binary of text data to a file. We use this suite of functions given above for such taskas. </p>
<p>The first of these, <code>Path.open</code> provides a file descriptor for the open file. This is used to interface to other input/output functions in Python. A typical example of this is reading a configuration file in <a href="http://zetcode.com/python/yaml/"><code>yaml</code> format</a>.</p>
<p>The usual way of opening a file to get the file descriptor is:</p>
<pre><code>with Path(filename).open('r') as f:
   # do some reading with f
   pass
</code></pre>
<p>We use the form <code>with ... as ...</code> here, so that the file descriptor <code>f</code> only exists within this construct and the file is automatically closed when we finish. Codes are spaced in inside the construct, as we have seen in <code>if ...</code> or <code>for ... in ...</code> constructs.</p>
<p>Here, we have set the flag <code>r</code> within the <code>open()</code> statement (this is the default mode). This means that the file will be opened for <em>reading</em> only. Alternatives include <code>w</code> for writing, or <code>w+</code> for appending.</p>
<p>In the following example, we use <code>Path</code> to open the file <a href="../bin/copy/environment.yml"><code>bin/copy/environment.yml</code></a> and read it using the <code>yaml</code> library. This file specifies which packages are loaded in our Python environment. It has a simple ascii format, but since it is a <code>yaml</code> file, we should read it with code that interprets the format correctly and safely into a dictionary. This is done using <code>yaml.safe_load(f)</code> with <code>f</code> an open file descriptor.</p>
<pre><code class="python">from pathlib import Path
import yaml

# form the file name
yaml_file = Path('bin','copy','environment.yml')

with yaml_file.open('r') as f:
    env = yaml.safe_load(f)

print(f'env is type {type(env)}')
print(f'env keys: {env.keys()}')
</code></pre>

<pre><code>env is type &lt;class 'dict'&gt;
env keys: dict_keys(['name', 'channels', 'dependencies'])
</code></pre>
<p>The equivalent, reading the data from a URL is:</p>
<pre><code class="python">from geog0111.gurlpath import URL
import yaml

# form the file name
site = 'https://raw.githubusercontent.com'
site_dir = '/UCL-EO/geog0111/master'
site_file = 'copy/environment.yml'
yaml_file = URL(site,site_dir,site_file)

# notice that we can use verbose=True for URL open
with yaml_file.open('r',verbose=True) as f:
    env = yaml.safe_load(f)

print(f'env is type {type(env)}')
print(f'env keys: {env.keys()}')
</code></pre>

<pre><code>env is type &lt;class 'dict'&gt;
env keys: dict_keys(['name', 'channels', 'dependencies'])


--&gt; reading data from https://raw.githubusercontent.com/UCL-EO/geog0111/master/copy/environment.yml
--&gt; open() text stream
</code></pre>
<p>Another common file format for configuration information is <a href="https://www.json.org/json-en.html"><code>json</code></a>. We can use the same form of code as above to write the information in <code>env</code> into a <code>json</code> format file:</p>
<pre><code class="python">from pathlib import Path
import json

# form the file name
json_file = Path('bin','copy','environment.json')

with json_file.open('w') as f:
    json.dump(env, f)
</code></pre>

<h2 id="read-and-write-text">read and write text</h2>
<p>We can read text from a file with <code>Path.read_text()</code> or from a URL with <code>URL.read_text()</code>, then either <code>Path.write_text()</code> or  <code>URL.write_text()</code> to write text to a file:</p>
<pre><code class="python"># from https://www.json.org
some_text = '''
It is easy for humans to read and write.
It is easy for machines to parse and generate. 
'''

# set up the filename
outfile = Path('work/easy.txt')
# write the text
nbytes = outfile.write_text(some_text)
# print what we did
print(f'wrote {nbytes} bytes to {outfile}')
</code></pre>

<pre><code>wrote 90 bytes to work/easy.txt
</code></pre>
<h4 id="exercise-1">Exercise 1</h4>
<ul>
<li>Using <code>Path.read_text()</code> read the text from the file <code>work/easy.txt</code> and print the text returned.</li>
<li>split the text into lines of text using <code>str.split()</code> at each newline, and print out the resulting list</li>
</ul>
<p>You learned how to split strings in <a href="../013_Python_string_methods/#split()-and-join()">013_Python_string_methods</a></p>
<p>We can show that we get the same result reading the same file locally or from the web:</p>
<pre><code class="python">from geog0111.gurlpath import URL
from pathlib import Path

# first read the data
u = 'https://www.json.org/json-en.html'
url = URL(u)
# set the output dir
url.local_dir='data'

data = url.read_text(verbose=False)

# write to 'data/json-en.html' with URL
osize = url.write_text(data)
# test the correct number of bytes
assert osize == 26718
print('passed URL')

# write to 'data/json-en.html' with Path
osize = Path('data/json-en.html').write_text(data)
# test the correct number of bytes
assert osize == 26718
print('passed Path')

</code></pre>

<pre><code>passed URL
passed Path
</code></pre>
<p>The <code>URL</code> class has a few advantages over using <code>Path</code> in this way:</p>
<ul>
<li>if the output directory doesn't already exist, it will be created</li>
<li>if we set a <code>noclobber=True</code> flag, then we will not try to write the file if it already exists.</li>
</ul>
<p>For example:</p>
<pre><code class="python">from geog0111.gurlpath import URL
from pathlib import Path

# first read the data
u = 'https://www.json.org/json-en.html'
url = URL(u)
url.local_dir='data'

data = url.read_text()

# write to 'data/json-en.html' with URL
osize = url.write_text(data,verbose=True,noclobber=True)
</code></pre>

<pre><code>--&gt; local file data/json-en.html
--&gt; existing file data/json-en.html
--&gt; noclobber: True
--&gt; opening local file data/json-en.html
--&gt; mkdir local dir data
--&gt; file exists so not writing
--&gt; done : 26880
</code></pre>
<h4 id="exercise-2">Exercise 2</h4>
<p>XXX TODO XXX</p>
<h2 id="read-and-write-binary-data">read and write binary data</h2>
<p>We can read binary data from a file with <code>Path.read_bytes()</code> or from a URL with <code>URL.read_bytes()</code>, then either <code>Path.write_bytes()</code> or  <code>URL.write_bytes()</code> to write the binary data to a file.</p>
<p>Let's first access a MODIS file from the web, as we did in <a href="../020_Python_files/">020_Python_files</a>:</p>
<pre><code class="python">from  geog0111.modis import Modis

modis = Modis('MCD15A3H',verbose=True)
url = modis.get_url(&quot;2020&quot;,&quot;01&quot;,&quot;01&quot;)[0]
</code></pre>

<pre><code>--&gt; wildcards in: ['*.h08v06*.hdf']
--&gt; level 0/1 : *.h08v06*.hdf
--&gt; trying https://e4ftl01.cr.usgs.gov/MOTA/MCD15A3H.006/2020.01.01
--&gt; discovered 1 files with pattern *.h08v06*.hdf in https://e4ftl01.cr.usgs.gov/MOTA/MCD15A3H.006/2020.01.01
</code></pre>
<p>Now, pull the dataset </p>
<pre><code class="python"># set the output directory
url.local_dir = 'work'
# read the dataset
hdf_data = url.read_bytes()
# and save to a file
obytes = url.write_bytes(hdf_data,verbose=True)
</code></pre>

<pre><code>--&gt; local file work/MCD15A3H.A2020001.h08v06.006.2020006032951.hdf
--&gt; opening local file work/MCD15A3H.A2020001.h08v06.006.2020006032951.hdf
--&gt; mkdir local dir work
--&gt; writing data ...
--&gt; done : 9067184
--&gt; done : 9067184
</code></pre>
<h3 id="exercise-3">Exercise 3</h3>
<p>Using the code:</p>
<pre><code>from  geog0111.modis import Modis

# get URL
modis = Modis('MCD15A3H',verbose=True)
url = modis.get_url("2020","01","01")[0]
# set the output directory
url.local_dir = 'work'

# read the dataset
hdf_data = url.read_bytes()
# and save to a file
obytes = url.write_bytes(hdf_data,verbose=True)
</code></pre>
<ul>
<li>write a function that only calls <code>url.read_bytes()</code> if the file doesn't already exist</li>
<li>If it already exists, just read the data from that file</li>
<li>test your code with the url generated above and show that the file size is 9067184 bytes</li>
</ul>
<p>You will need to remember how to get the filename from the URL object, and also to test if a file exists. We learned all of these in <a href="../020_Python_files/">020_Python_files</a>.</p>
<p>Note that <code>len(data)</code> will give the size of bytes data.</p>
<h4 id="exercise-4">Exercise 4</h4>
<ul>
<li>print out the absolute pathname of the directory that the binary file <a href="../images/ucl.png"><code>images/ucl.png</code></a> is in</li>
<li>print the size of the file in kilobytes (KB) to two decimal places without reading the datafile. </li>
<li>read the datafile, and check you get the same data size</li>
</ul>
<p>You will need to recall how to find a file size in bytes using <code>Path</code>. This was covered in <a href="../020_Python_files/">020_Python_files</a>. You will need to know how many bytes are in a KB. To print to two decimal places, you need to recall the string formatting we did in <a href="../012_Python_strings/#String-formating">012_Python_strings</a>.</p>
<h3 id="135-summary">1.3.5 Summary</h3>
<p>In this section, we have used <code>Path</code> and <code>URL</code> classes to read and write text and binary files. We have combined these ideas with earlier work to download and save a MODIS datafile and other text and binary datasets. We have refreshed our memory of some of the earlier material, especially string formatting.</p>
<p>You should now have some confidence in these matters, so that if you were set a task of downloading and saving datasets, as well as other tasks such as finding their size, whether the exists or not, you could do this. </p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../022_NASA_MODIS_Earthdata/" class="btn btn-neutral float-right" title="NASA MODIS Earthdata">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../020_Python_files/" class="btn btn-neutral" title="Python Files"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/UCL-EO/geog0111/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../020_Python_files/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../022_NASA_MODIS_Earthdata/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
