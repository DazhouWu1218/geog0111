
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>036 Model Fitting &#8212; GEOG0111 Scientific Computing 1.0.1 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="030 NASA MODIS Earthdata : Answers to exercises" href="030_NASA_MODIS_Earthdata_answers.html" />
    <link rel="prev" title="035 Weighted interpolation" href="035_Weighted_interpolation.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="model-fitting">
<h1>036 Model Fitting<a class="headerlink" href="#model-fitting" title="Permalink to this headline">¶</a></h1>
<p>NOT FINISHED</p>
<div class="section" id="test">
<h2>Test<a class="headerlink" href="#test" title="Permalink to this headline">¶</a></h2>
<p>You should run a <a class="reference internal" href="004_Accounts.html"><span class="doc">NASA account test</span></a> if you have not already done so.</p>
<p>Fit to LAI curves …</p>
<p>In the previous session, we looked at fitting linear models to observations. While this is a very common task, complex processes might require models which are non-linear.</p>
<p>One non-linear model is modelling LAI as a function of time (or temperature). In the Nothern Hemisphere, and for temperate latitudes, there is a clear seasonal cycle in vegetation, particularly visible in leaf area index (LAI). LAI dynamics can possibly be depicted by a “double logistic” curve. Mathematically, the double logistic looks like this</p>
<p><img alt="A double logistic" src="https://camo.githubusercontent.com/7a664a29ec5bc190d71d8ba5ec391bcf98848df7/687474703a2f2f777777322e67656f672e75636c2e61632e756b2f7e706c657769732f67656f67673132342f5f696d616765732f7a68616e67312e706e67" /></p>
<p>Mathematically, the function predicts the e.g. LAI (or some vegetation index) as</p>
<p>$$
y = p_0 - p_1\cdot\left[\frac{1}{1+\exp\left(p_2\cdot(t-p_3)\right)} + \frac{1}{1+\exp\left(-p_4\cdot(t-p_5)\right)} - 1\right].
$$</p>
<p>If we inspect this form, we can probably guess that $p_0$ and $p_1$ scale the vertical span of the function, whereas $p_3$ and $p_5$ are some sort of temporal shift, and the remaining parameters $p_2$ and $p_4$ control the slope of the two flanks. Something that will give rise to a self-respecting LAI curve might be</p>
<ul class="simple">
<li><p>$p_0= 0.1$</p></li>
<li><p>$p_1= 2.5$</p></li>
<li><p>$p_2=0.19$</p></li>
<li><p>$p_3= 120$</p></li>
<li><p>$p_4= 0.13$</p></li>
<li><p>$p_5= 220$</p></li>
</ul>
<div class="alert alert-danger">
<p>Write a function that produces the double logistic when passed an array of time steps (e.g. 1 to 365), and an array with six parameters.</p>
<p>Do some plots and try to get some intuition on the model parameters!</p>
</div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># All imports go here. Run me first!</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>  <span class="c1"># Checks for files and so on</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>  <span class="c1"># Numpy for arrays and so on</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>  <span class="c1"># Matplotlib for plotting</span>
<span class="c1"># Ensure the plots are shown in the notebook</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>

<span class="kn">import</span> <span class="nn">gdal</span>
<span class="kn">import</span> <span class="nn">osr</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
<div class="section" id="a-synthetic-experiment">
<h2>A synthetic experiment<a class="headerlink" href="#a-synthetic-experiment" title="Permalink to this headline">¶</a></h2>
<p>A first step is to do a synthetic experiment. This has the marked advantage of being a situation where we’re in control of everything.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">366</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mf">0.19</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mf">0.13</span><span class="p">,</span> <span class="mi">220</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">dbl_sigmoid_function</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="n">yn</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span><span class="o">*</span><span class="mf">0.6</span>

<span class="n">selector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">365</span><span class="p">)</span>

<span class="n">passer</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">selector</span> <span class="o">&gt;</span> <span class="mf">0.9</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

<span class="n">tn</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">passer</span><span class="p">]</span>
<span class="n">yn</span> <span class="o">=</span> <span class="n">yn</span><span class="p">[</span><span class="n">passer</span><span class="p">]</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Ground truth&quot;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tn</span><span class="p">,</span> <span class="n">yn</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Simulated observations&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;DoY&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;LAI&quot;</span><span class="p">)</span>

</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="s1">&#39;LAI&#39;</span><span class="p">)</span>



<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ucfajlg</span><span class="o">/</span><span class="n">miniconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">python3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">matplotlib</span><span class="o">/</span><span class="n">font_manager</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1328</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">findfont</span><span class="p">:</span> <span class="n">Font</span> <span class="n">family</span> <span class="p">[</span><span class="s1">&#39;sans-serif&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="n">found</span><span class="o">.</span> <span class="n">Falling</span> <span class="n">back</span> <span class="n">to</span> <span class="n">DejaVu</span> <span class="n">Sans</span>
  <span class="p">(</span><span class="n">prop</span><span class="o">.</span><span class="n">get_family</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">defaultFamily</span><span class="p">[</span><span class="n">fontext</span><span class="p">]))</span>
</pre></div>
</div>
<p><img alt="png" src="_images/036_Model_Fitting_4_2.png" /></p>
<p>We know that the “true parameters” are given by <code class="docutils literal notranslate"><span class="pre">p</span> <span class="pre">=</span> <span class="pre">np.array([0.1,</span> <span class="pre">2.5,</span> <span class="pre">0.19,</span> <span class="pre">120,</span> <span class="pre">0.13,</span> <span class="pre">220])</span></code>, but we see that the data is quite noisy and has significant gaps. As per last session, we could try to modify the parameters “by hand”, and see how far we get, but given that it’s 6, with different ranges, it looks a bit daunting. Also, we’d need to assess how good the solution is for a particular set of parameters, in other words, select a metric to quantify the goodness of fit.</p>
<p>It is useful to consider a model of the incomplete, noisy observations of LAI ($y_n$) and the true value of LAI, $y$. For overlapping time steps, the noisy data are just the “true” data plus some random Gaussian value with zero mean and a given variance $\sigma_{obs}^2$ (in the experiment above, $\sigma_{obs}=0.6$):</p>
<p>$$
y_n^{i} = y^{i} + \mathcal{N}(0, \sigma_{obs}^2).
$$</p>
<p>Rearranging things, we have that $y_n - y$ should be a zero mean Gaussian distribution with known variance. We have assumed that our model is $f(\vec{p})=y$, so we can write the <em>likelihood function</em>, $l(\vec{p})$</p>
<p>$$
l(\vec{p}) = \left[\frac{1}{\sqrt{2\pi\sigma_{obs}^2}}\right]^{N}\displaystyle{\prod_{i=1}^{N} \exp\left[-\frac{(y_n^{i}-f(\vec{p})^{i})^2}{2\sigma_{obs}^2}   \right]}.
$$</p>
<p>It is convenient to take a logarithm of $l(\vec{p})$, so that we have the <strong>log-likelihood</strong>:</p>
<p>$$
L(\vec{p}) = -\displaystyle{\sum_{i=1}^{N} \left[\frac{(y_n^{i}-f(\vec{p})^{i})^2}{2\sigma_{obs}^2}   \right]} + \textrm{Const.}
$$</p>
<div class="alert alert-success">
Think about the likelihood and log-likelihood... Think (and possibly plot) how a negative exponential curve looks like, and what conditions are for some interesting points.
</div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">Legend</span> <span class="n">at</span> <span class="mh">0x7fdd3698d358</span><span class="o">&gt;</span>



<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ucfajlg</span><span class="o">/</span><span class="n">miniconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">python3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">matplotlib</span><span class="o">/</span><span class="n">font_manager</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1328</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">findfont</span><span class="p">:</span> <span class="n">Font</span> <span class="n">family</span> <span class="p">[</span><span class="s1">&#39;sans-serif&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="n">found</span><span class="o">.</span> <span class="n">Falling</span> <span class="n">back</span> <span class="n">to</span> <span class="n">DejaVu</span> <span class="n">Sans</span>
  <span class="p">(</span><span class="n">prop</span><span class="o">.</span><span class="n">get_family</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">defaultFamily</span><span class="p">[</span><span class="n">fontext</span><span class="p">]))</span>
</pre></div>
</div>
<p><img alt="png" src="_images/036_Model_Fitting_7_2.png" /></p>
<p>So for a sum of squares, the most likely result would be if all the mismatches were zero, which means that the log-likelihood is 0, and the likelihood, $exp(0)=1$!</p>
<p>However, the mismatch might not be 0, due to the added noise. So what we’re effectively looking for is a <strong>maximum</strong> in the log-likelihood, or a <strong>minimum</strong> of its negative as a function of $\vec{p}$:</p>
<p>$$
\frac{\partial (-L(\vec{p}))}{\partial \vec{p}} \triangleq \min
$$</p>
<p>So, we can try our brute force guessing approach by <strong>minimising the cost function given by $L(\vec{p})$</strong></p>
<div class="alert alert-danger">
Write the cost function! Test it possibly shifting one parameter over some range of values
</div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>The easiest way to obtain the solution is to use numerical optimisation techniques to minimise the cost function. In scipy, there’s <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/optimize.html">a good selection of function optimisers</a>. We’ll be looking at <strong>local</strong> optimisers: these will look for a minimum in the vicinity of a user-given starting point, usually by looking at the gradient of the cost function. The main function to consider here is <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html#scipy.optimize.minimize"><code class="docutils literal notranslate"><span class="pre">minimise</span></code></a>. Basically, <code class="docutils literal notranslate"><span class="pre">minimize</span></code> takes a cost function, a starting point, and maybe extra arguments that are passed to the cost function, and uses one of several algorithms to minimise the cost function. We import it with</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">minimize</span>
</pre></div>
</div>
<p>From the <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html#scipy.optimize.minimize">documentation</a>,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="n">minimize</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">method</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">jac</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hess</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hessp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">bounds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">constraints</span><span class="o">=</span><span class="p">(),</span> <span class="n">tol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>Basically, <code class="docutils literal notranslate"><span class="pre">fun</span></code> is the name of the cost function. The first parameter you pass to the cost function has to be an array with the parameters that will be used to calculate the cost. <code class="docutils literal notranslate"><span class="pre">x0</span></code> is the starting point. <code class="docutils literal notranslate"><span class="pre">args</span></code> allows you to add extra parameters that are required for the cost function (in our example, these would be <code class="docutils literal notranslate"><span class="pre">t,</span> <span class="pre">y_obs,</span> <span class="pre">passer,</span> <span class="pre">sigma_obs</span></code>).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">minimize</span></code> function returns an object with the</p>
<ol class="simple">
<li><p>Value of the function at the minimum,</p></li>
<li><p>The value of the input parameters that attain the minimum,</p></li>
<li><p>A message telling you whether the optimisation succeeded</p></li>
<li><p>The number of iterations (<code class="docutils literal notranslate"><span class="pre">nit</span></code>) and total function evaluations (<code class="docutils literal notranslate"><span class="pre">nfev</span></code>)</p></li>
<li><p>Some diagnostics</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">minimize</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">minimize</span>

<span class="n">p0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mi">200</span><span class="p">])</span>

<span class="n">retval</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">cost_function</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">yn</span><span class="p">,</span> <span class="n">passer</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">retval</span><span class="p">)</span>

<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;********************************************&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">retval</span><span class="o">.</span><span class="n">success</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Optimisation successful!&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Value of the function at the minimum: </span><span class="si">{</span><span class="n">retval</span><span class="o">.</span><span class="n">fun</span><span class="si">:</span><span class="s2">g</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Value of the solution: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">retval</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="si">:</span><span class="s2">s</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>      <span class="n">fun</span><span class="p">:</span> <span class="mf">21.342085853280015</span>
 <span class="n">hess_inv</span><span class="p">:</span> <span class="n">array</span><span class="p">([[</span> <span class="mf">1.72923106e-02</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.15349312e-02</span><span class="p">,</span>  <span class="mf">2.11636346e-03</span><span class="p">,</span>
         <span class="mf">2.98572159e-02</span><span class="p">,</span>  <span class="mf">4.47526187e-03</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.30376564e-02</span><span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mf">2.15349312e-02</span><span class="p">,</span>  <span class="mf">1.13986002e-01</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.73509772e-02</span><span class="p">,</span>
         <span class="mf">5.02075575e-01</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.17466259e-02</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.55944527e-01</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">2.11636346e-03</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.73509772e-02</span><span class="p">,</span>  <span class="mf">7.51102753e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">5.51690150e-01</span><span class="p">,</span>  <span class="mf">2.61989471e-02</span><span class="p">,</span>  <span class="mf">2.73170740e-01</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">2.98572159e-02</span><span class="p">,</span>  <span class="mf">5.02075575e-01</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.51690150e-01</span><span class="p">,</span>
         <span class="mf">9.54855368e+00</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.19209970e-01</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.30673084e+00</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">4.47526187e-03</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.17466259e-02</span><span class="p">,</span>  <span class="mf">2.61989471e-02</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.19209970e-01</span><span class="p">,</span>  <span class="mf">5.74465509e-02</span><span class="p">,</span>  <span class="mf">3.44439220e-01</span><span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mf">5.30376564e-02</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.55944527e-01</span><span class="p">,</span>  <span class="mf">2.73170740e-01</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">3.30673084e+00</span><span class="p">,</span>  <span class="mf">3.44439220e-01</span><span class="p">,</span>  <span class="mf">8.29858275e+00</span><span class="p">]])</span>
      <span class="n">jac</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span> <span class="mf">4.76837158e-07</span><span class="p">,</span>  <span class="mf">4.52995300e-06</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.76837158e-07</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.76837158e-07</span><span class="p">,</span>
        <span class="mf">9.53674316e-07</span><span class="p">,</span>  <span class="mf">4.76837158e-07</span><span class="p">])</span>
  <span class="n">message</span><span class="p">:</span> <span class="s1">&#39;Optimization terminated successfully.&#39;</span>
     <span class="n">nfev</span><span class="p">:</span> <span class="mi">616</span>
      <span class="n">nit</span><span class="p">:</span> <span class="mi">63</span>
     <span class="n">njev</span><span class="p">:</span> <span class="mi">77</span>
   <span class="n">status</span><span class="p">:</span> <span class="mi">0</span>
  <span class="n">success</span><span class="p">:</span> <span class="kc">True</span>
        <span class="n">x</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mf">2.15760787e-01</span><span class="p">,</span> <span class="mf">2.22197385e+00</span><span class="p">,</span> <span class="mf">2.73744085e-01</span><span class="p">,</span> <span class="mf">1.23505589e+02</span><span class="p">,</span>
       <span class="mf">2.63305511e-01</span><span class="p">,</span> <span class="mf">2.22200329e+02</span><span class="p">])</span>
<span class="o">********************************************</span>
<span class="n">Optimisation</span> <span class="n">successful</span>
<span class="n">Value</span> <span class="n">of</span> <span class="n">the</span> <span class="n">function</span> <span class="n">at</span> <span class="n">the</span> <span class="n">minimum</span><span class="p">:</span> <span class="mf">21.3421</span>
<span class="n">Value</span> <span class="n">of</span> <span class="n">the</span> <span class="n">solution</span><span class="p">:</span> <span class="p">[</span><span class="mf">2.15760787e-01</span> <span class="mf">2.22197385e+00</span> <span class="mf">2.73744085e-01</span> <span class="mf">1.23505589e+02</span>
 <span class="mf">2.63305511e-01</span> <span class="mf">2.22200329e+02</span><span class="p">]</span>
</pre></div>
</div>
<div class="alert alert-danger">
Do some synthetic experiments. For example:
<ol>
    <li> Change the true parameters and see how the solution tracks the change.</li>
    <li> Increase the added variance</li>
    <li> Reduce or increase the number of observations</li>
</ol><p>Use these experiments to challenge your understanding of the problem: Try to think what the expected result of these changes is, and write a set of functions that simplify the exploration.</p>
</div></div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">GEOG0111 Scientific Computing</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="docindex.html">GEOG0111</a></li>
<li class="toctree-l1"><a class="reference internal" href="docindex.html#geog0111-scientific-computing">GEOG0111 Scientific Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="001_Notebook_use.html">001 Use of Jupyter notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="002_Unix.html">002 Some basic UNIX</a></li>
<li class="toctree-l1"><a class="reference internal" href="003_Help.html">003 Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="004_Accounts.html">004 Setup, Accounts and logins</a></li>
<li class="toctree-l1"><a class="reference internal" href="005_Packages.html">005 Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="001_Notebook_use_answers.html">001 Use of Jupyter notebooks : Answers to exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="002_Unix_answers.html">002 Some basic UNIX : Answers to exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="003_Help_answers.html">003 Help : Answers to exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="010_Python_Introduction.html">010 Introduction to Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="011_Python_data_types.html">011 Python data types</a></li>
<li class="toctree-l1"><a class="reference internal" href="012_Python_strings.html">012 String formatting</a></li>
<li class="toctree-l1"><a class="reference internal" href="013_Python_string_methods.html">013 String methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="014_Python_groups.html">014 Groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="015_Python_control.html">015 Control in Python: <code class="docutils literal notranslate"><span class="pre">if</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="016_Python_for.html">016 More control in Python: <code class="docutils literal notranslate"><span class="pre">for</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="017_Functions.html">Functions in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="018_Running_Python.html">018 Python codes</a></li>
<li class="toctree-l1"><a class="reference internal" href="010_Python_Introduction_answers.html">010 Introduction to Python : Answers to exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="011_Python_data_types_answers.html">011 Python data types : Answers to exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="012_Python_strings_answers.html">012 String formatting : Answers to exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="013_Python_string_methods_answers.html">013 String methods : Answers to exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="014_Python_groups_answers.html">014 Groups : Answers to exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="015_Python_control_answers.html">015 Control in Python: <code class="docutils literal notranslate"><span class="pre">if</span></code> : Answers to exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="016_Python_for_answers.html">016 More control in Python: <code class="docutils literal notranslate"><span class="pre">for</span></code> : Answers to exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="017_Functions_answers.html">Functions in Python : Answers to exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="018_Running_Python_answers.html">018 Python codes : Answers to exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="020_Python_files.html">020 Files and other Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="021_Streams.html">021 Streams</a></li>
<li class="toctree-l1"><a class="reference internal" href="022_Read_write_files.html">022 Read and Write: URLs and files</a></li>
<li class="toctree-l1"><a class="reference internal" href="023_Plotting.html">Plotting Graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="024_Image_display.html">024 Image display</a></li>
<li class="toctree-l1"><a class="reference internal" href="020_Python_files_answers.html">020 Files and other Resources : Answers to exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="021_Streams_answers.html">021 Streams : Answers to exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="022_Read_write_files_answers.html">022 Read and Write: URLs and files : Answers to exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="023_Plotting_answers.html">Plotting Graphs : Answers to exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="024_Image_display_answers.html">024 Image display : Answers to exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="030_NASA_MODIS_Earthdata.html">030 NASA MODIS Earthdata</a></li>
<li class="toctree-l1"><a class="reference internal" href="030_NASA_MODIS_Earthdata.html#summary">Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="031_Numpy.html">031 Manipulating data: <code class="docutils literal notranslate"><span class="pre">numpy</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="032_GDAL_mosaicing_and_masking.html">032 GDAL: mosaicing and masking</a></li>
<li class="toctree-l1"><a class="reference internal" href="033_GDAL_timeseries.html">033 GDAL: time series</a></li>
<li class="toctree-l1"><a class="reference internal" href="034_Weigthed_smoothing_and_interpolation.html">034 Weighted interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="035_Weighted_interpolation.html">035 Weighted interpolation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">036 Model Fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="030_NASA_MODIS_Earthdata_answers.html">030 NASA MODIS Earthdata : Answers to exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="031_Numpy_answers.html">031 Manipulating data: <code class="docutils literal notranslate"><span class="pre">numpy</span></code> : Answers to exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="032_GDAL_mosaicing_and_masking_answers.html">032 GDAL: mosaicing and masking : Answers to exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="040_Practical_Part1.html">Assessed Practical</a></li>
<li class="toctree-l1"><a class="reference internal" href="041_Practical_Part2.html">041 Assessed Practical</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="035_Weighted_interpolation.html" title="previous chapter">035 Weighted interpolation</a></li>
      <li>Next: <a href="030_NASA_MODIS_Earthdata_answers.html" title="next chapter">030 NASA MODIS Earthdata : Answers to exercises</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, P. Lewis and J. Gomez-Dans.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.2.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/036_Model_Fitting.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>